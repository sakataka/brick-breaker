# ゲームガイド

## 1. 基本操作

- マウス移動: パドル移動
- 左クリック / `Enter` / `Space`: 開始・再開・次ステージへ進行
- `P`: 一時停止 / 再開
- 右クリック: 魔法スキル（クールダウンあり）

## 2. ゲーム進行

- 全12ステージのキャンペーン構成です。
- 4面クリア後にルート分岐（A/B）があります。
- 残機はステージ間で持ち越し、ステージクリアで回復しません。
- 残機0でゲームオーバー時は同ステージ再挑戦になります。
- スコアはステージ開始時点に巻き戻されるため、失敗による稼ぎはできません。

## 3. 評価と目標

- 各ステージに時間ミッションがあり、クリア時に達成判定されます。
- 評価は ★1〜★3（時間 / 被弾 / 残機）で決まります。
- 最終クリア時にステージごとの結果一覧を表示します。

## 4. アイテム

ドロップアイテム（8種）:
- `paddle_plus`: パドル幅拡張
- `slow_ball`: ボール速度抑制
- `multiball`: ボール追加（開始設定で設定した上限まで）
- `shield`: 下部バリア
- `pierce`: 貫通（上限1）
- `bomb`: 爆発（上限1）
- `laser`: 自動レーザー（上限2）
- `sticky`: パドル一時保持（上限1）

仕様:
- 同時落下上限: 3
- 基本ドロップ率: 18%
- 効果は重ね取りで加算（`pierce` / `bomb` / `sticky` は上限1、`laser` は上限2）
- 全ボール喪失時に効果が解除されます
- `bomb` と `pierce` は有効中、同種ドロップが抑制されます
- シールド救済成功時はシールドバーストが発動し、近傍ブロックへ反撃します

## 5. ステージ修飾子（後半）

- ワープゾーン: 青い矩形が入口、黄色い点/リングが出口、青いガイド線が接続先を示します
- 高速球: ボール速度上限が上がる
- 浮遊敵: 接触で追加スコアを獲得
- フラックスフィールド: パドル周辺で下降時は吸引、上昇時は外向き反発がかかる

## 6. ショップ

- 1ステージにつき1回だけ購入可能です（2択）。
- 購入にはスコアコストが必要です。
- ショップUIは右上（HUD下）に固定され、プレイ領域と重ならないように配置されます（モバイルは下部表示）。

## 7. 開始前設定

- 開始画面のカードは「ヘッダー / 設定スクロール領域 / 固定フッター（開始ボタン）」で構成されています。
- 項目が増えても、スクロールするのは設定欄のみで、開始ボタンは常時押せます。
- デバッグ設定は `デバッグモード` を ON にしたときだけ展開されます。

- 難易度（カジュアル / スタンダード / ハード）
- 初期残機（1〜6）
- 速度倍率（75% / 100% / 125%）
- マルチボール上限
- 新アイテムスタック（初期値OFF）
- デバッグモード（初期値OFF）
  - 開始ステージ（1〜12）
  - シナリオ（通常 / 敵確認 / ボス確認）
  - アイテムプリセット（なし / 戦闘確認 / ボス確認）
  - 結果記録（記録しない / 記録する）
- ルート選択、デイリー、チャレンジ、リスク倍率
- BGM/SE ON/OFF

デバッグ補足:
- `敵確認` は 9面開始、`ボス確認` は 12面開始で固定です。
- `記録しない` を選んだ場合、ステージ評価表示は出ますが、最終結果一覧へは保存されません。
- `ボス確認` プリセットは `shield=2, pierce=1, bomb=1, laser=2, sticky=1` を付与します（新アイテムスタックOFF時は `laser=1`）。

## 8. トラブル時チェック

- 表示が崩れる場合: ブラウザのハードリロードを実行
- 入力が効かない場合: Overlayが表示されたままになっていないか確認
- 音が出ない場合: 開始前設定の BGM/SE が ON か確認
- 高解像度でぼやける場合: このゲームは `DPR上限2` で描画されます。ブラウザ拡大率やOS側スケールを見直してください

## 9. BGMについて

- BGMは外部音源ファイルを使わず、WebAudio合成で再生しています。
- 旋律はパブリックドメインの古典曲モチーフを基にした構成です。
- 発音は単音ではなく、メロディにハーモニーを重ねる同時発音（3和音系）にしています。
  - Bach Minuet in G major (BWV Anh. 114)
  - Mozart Sonata K.545
  - Bach Invention No.1 (BWV 772)
  - Beethoven Symphony No.9 (Ode to Joy)
